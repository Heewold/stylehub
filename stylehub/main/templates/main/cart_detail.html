{% extends 'base.html' %}
{% block content %}
<h2 class="mb-4"><i class="bi bi-cart-fill"></i> Корзина</h2>

{% if cart|length == 0 %}
  <div class="alert alert-info">
    Ваша корзина пуста.
  </div>
  <a href="{% url 'product_list' %}" class="btn btn-outline-secondary">
    ← Вернуться в каталог
  </a>
{% else %}
  <table class="table table-bordered table-striped align-middle">
    <thead class="table-dark">
      <tr>
        <th>Товар</th>
        <th>Цена</th>
        <th>Кол-во</th>
        <th>Сумма</th>
        <th></th>
      </tr>
    </thead>
    <tbody>
      {% for item in cart %}
      <tr>
        <td>{{ item.product.name }}</td>
        <td>{{ item.price }} ₽</td>
        <td>{{ item.quantity }}</td>
        <td>{{ item.total_price }} ₽</td>
        <td>
          <a href="{% url 'cart_remove' item.product.id %}" class="btn btn-sm btn-danger">
            <i class="bi bi-trash"></i>
          </a>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>

  <div class="d-flex justify-content-between align-items-center mt-4">
    <h4 class="mb-0">Итого: {{ cart.get_total_price }} ₽</h4>

    <div>
      {% if user.is_authenticated %}
        <a href="{% url 'order_create' %}" class="btn btn-success me-2">
          <i class="bi bi-check-circle"></i> Оформить заказ
        </a>
      {% else %}
        <span class="text-danger me-2">Войдите, чтобы оформить заказ</span>
        <a href="{% url 'login' %}" class="btn btn-outline-primary">Вход</a>
      {% endif %}
      <a href="{% url 'product_list' %}" class="btn btn-outline-secondary">
        ← Назад в каталог
      </a>
    </div>
  </div>
{% endif %}
{% endblock %}
